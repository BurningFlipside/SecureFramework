function login_submit_done(a){if(200!=a.status){var b=1*getParameterByName("failed"),c=window.location;b++,window.location=window.loginUrl+"?failed="+b+"&return="+c}else if(void 0!==a.responseJSON){var d=a.responseJSON,e="";e=d.return?d.return:window.location,d.extended&&(e+="?extended="+d.extended),window.location=e}}function login_submitted(a){var b=$("script[src*=login]").attr("src"),c=b.split("/").pop();b=b.replace("/"+c,""),c=b.split("/").pop(),b=b.replace("/"+c,""),$.ajax({url:b+"/api/v1/login",data:$(a).serialize(),type:"post",dataType:"json",complete:login_submit_done})}function login_dialog_shown(){$("[name=username]").focus()}function do_login_init(){var a=$(".links a[href*='login']");browser_supports_cors()?(a.attr("data-toggle","modal"),a.attr("data-target","#login-dialog"),a.removeAttr("href"),a.css("cursor","pointer"),a=$("#content a[href*='login']"),a.attr("data-toggle","modal"),a.attr("data-target","#login-dialog"),a.removeAttr("href"),a.css("cursor","pointer")):a.attr("href",a.attr("href")+"?return="+document.URL),$("#login_main_form").length>0&&$("#login_main_form").validate({submitHandler:login_submitted}),$("#login_dialog_form").length>0&&$("#login_dialog_form").validate({submitHandler:login_submitted}),$("#login-dialog").length>0&&($("#login-dialog").modal({show:!1,backdrop:"static"}),$("#login-dialog").on("shown.bs.modal",login_dialog_shown))}$(do_login_init);